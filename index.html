<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-flash.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="/atom.xml" title="Mr_Chen" type="application/atom+xml">






<meta name="description" content="人生没有回头路">
<meta property="og:type" content="website">
<meta property="og:title" content="Mr_Chen">
<meta property="og:url" content="https://seasand1024.github.io/index.html">
<meta property="og:site_name" content="Mr_Chen">
<meta property="og:description" content="人生没有回头路">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Mr_Chen">
<meta name="twitter:description" content="人生没有回头路">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://seasand1024.github.io/">





  <title>Mr_Chen</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Mr_Chen</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">yyds</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br>
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-movies">
          <a href="/movies/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-film"></i> <br>
            
            观影
          </a>
        </li>
      
        
        <li class="menu-item menu-item-books">
          <a href="/books/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br>
            
            阅读
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://seasand1024.github.io/2022/10/02/两公里的月光/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="安徒生">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/head.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr_Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/10/02/两公里的月光/" itemprop="url">两公里的月光</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-10-02T01:18:25+08:00">
                2022-10-02
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/现代诗/" itemprop="url" rel="index">
                    <span itemprop="name">现代诗</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>有人说 时光总在深夜流逝<br>可是一直要到了今夜<br>我才能明白<br>仿佛是在风中纷纷翻动的书页<br>时光也会在深夜翩然而至</p>
<p>当月色澄明如水<br>溶入四野<br>仿佛是风中纷纷翻动的书页<br>带着轻微的颤栗与喘息<br>时光在我们眼前浮现<br>千世的繁华<br>千世的劫难</p>
<p>在每一次月圆之夜的祭奠里<br>我们想必都曾经一如今夜这样地<br>携手并肩而行<br>而月色如水<br>穿越过松林<br>在这两公里的山径上<br>与我们静静相对的<br>是两公里的悲欢<br>两公里的月光</p>
<p><img src="../../../../images/post-images/image.png" alt="image.png"></p>

          
        
      
    </div>
    
    
    

    <div>
          
    </div>

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://seasand1024.github.io/2023/05/20/大数据系统设计思路概览与Flink SQL构建实时数仓介绍演示/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="安徒生">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/head.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr_Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/05/20/大数据系统设计思路概览与Flink SQL构建实时数仓介绍演示/" itemprop="url">⼤数据系统设计思路概览</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2023-05-20T18:26:00+08:00">
                2023-05-20
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据开发/" itemprop="url" rel="index">
                    <span itemprop="name">数据开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>⼀</strong> .<strong>⼤数据系统设计思路概览</strong></p>
<p><strong>⼤数据概念与传统定义</strong></p>
<p><strong>狭义的⼤数据</strong>–<strong>专⻔的⼤数据软硬件以及服务</strong></p>
<p><strong>源起</strong>Google<strong>搜索引擎背后的三驾⻢⻋</strong></p>
<ul>
<li>GFS</li>
<li>MapReduce</li>
<li>BigTable</li>
</ul>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.001.jpeg" alt="img.jpeg"></p>
<p><strong>从</strong>GFS<strong>到</strong>DataFlow,19<strong>年⼤数据架构⽣态演进</strong></p>
<ul>
<li>Lambda 架构</li>
<li>Kappa 架构</li>
</ul>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.002.jpeg" alt="img.jpeg"></p>
<p><strong>⼴义的⼤数据</strong>–<strong>“⼤数据”是指传统数据处理应⽤软件时，不⾜以处理的⼤的或者复杂的数据集 的术语</strong></p>
<p><strong>维基百科的定义</strong></p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.003.jpeg" alt="img.jpeg"></p>
<p><strong>⼤数据的</strong>4V</p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.004.jpeg" alt="img.jpeg"></p>
<p><strong>⼤数据技术</strong>–<strong>⼤数据技术其实是计算机科学中很多科⽬的综合应⽤</strong></p>
<p><strong>简单的⼤数据技术栈</strong></p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.005.jpeg" alt="img.jpeg"></p>
<p><strong>⼤数据分类–基于系统层⾯开展的细分领域</strong></p>
<p><strong>分布式系统</strong></p>
<p><strong>数据编码</strong></p>
<p>数据表现形式⽆⾮两种：</p>
<ul>
<li>内存中数据保存对象，结构体、列表、数组、哈希表和树结构等等，传统的数据结构对于 CPU⾼效访问优化。</li>
<li>数据写⼊⽂件通过⽹络发送，必须要编码为某种字节序列，但是由于⼀些虚拟字节⽐如指针的存在所以和内存的表现形式有可能不⼀样。</li>
</ul>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.006.jpeg" alt="img.jpeg"></p>
<p><strong>数据分区</strong></p>
<p>哈希分区</p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.007.jpeg" alt="img.jpeg"></p>
<p>范围分区</p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.008.jpeg" alt="img.jpeg"></p>
<p><strong>数据复制</strong></p>
<p>单领导者（单主复制）</p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.009.jpeg" alt="img.jpeg"></p>
<p>多领导者（多主复制）</p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.010.jpeg" alt="img.jpeg"></p>
<p>⽆领导者（⽆主复制）</p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.011.jpeg" alt="img.jpeg"></p>
<p>每种⽅法都有优点和缺点。单主复制是⾮常流⾏的，因为它很容易理解，不需要担⼼冲突解决。在出现故障节点，⽹络中断和延迟峰 值的情况下，多领导者和⽆领导者复制可以更加稳健，但代价很难推测，只能提供⾮常弱的⼀致性保证。</p>
<p>复制可以是同步的，也可以是异步的，在发⽣故障时对系统⾏为有深远的影响。尽管在系统运⾏平稳时异步复制速度很快，但是在复 制滞后增加和服务器故障时要弄清楚会发⽣什么， 这⼀点很重要。如果⼀个领导者失败了，并且你推动⼀个异步更新的追随者成为新 的领导者，那么最近承诺的数据可能会丢失。</p>
<p><strong>数据检索与索引</strong> </p>
<p>哈希索引</p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.012.jpeg" alt="img.jpeg"></p>
<p>SSTables和 LSM TREE<br><img src="../../../../images/post-images/bigData/../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.013.jpeg" alt></p>
<p>合并多个 SSTable 段，仅保留每个键的最新值。</p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.014.jpeg" alt></p>
<p>SSTable 及其内存中的索引。</p>
<p><strong>数据模型</strong> 关系模型与⽂档模型</p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.015.jpeg" alt></p>
<p>图状数据模型</p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.016.jpeg" alt></p>
<p><strong>数据批处理与流处理</strong></p>
<p>mapreduce 模式的批处理</p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.017.jpeg" alt></p>
<p>flink的 dataflow流处理模式</p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.018.jpeg" alt></p>
<p><strong>数据事务⼀致性</strong></p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.019.jpeg" alt></p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.020.jpeg" alt></p>
<p><strong>数据压缩与存储 列存储</strong></p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.021.jpeg" alt></p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.022.jpeg" alt></p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.023.png" alt></p>
<p><strong>数据⼀致性与共识</strong></p>
<p>分布式系统挑战</p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.024.jpeg" alt></p>
<p>2PC/3PC和 Paxos协议是经典的分布式协议</p>
<p>Two Phase指的是 Commit-request阶段 Commit阶段。</p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.025.png" alt> 请求阶段</p>
<p>在请求阶段，协调者将通知事务参与者准备提交或取消事务，然后进⼊表决过程。 在表决过程中，参与者将告知协调者⾃⼰的决策：同意（事务参与者本地作业执⾏成功）或取消（本地作业执⾏故障）。</p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.026.png" alt> 提交阶段</p>
<p>在该阶段，协调者将基于第⼀个阶段的投票结果进⾏决策：提交或取消。 当且仅当所有的参与者同意提交事务协调者才通知所有的参与者提交事务，否则协调者将通知所有的参与者取消事务。参与者在接收 到协调者发来的消息后将执⾏响应的操作。</p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.027.png" alt></p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.028.png" alt> 同步阻塞</p>
<p>执⾏过程中，所有参与节点都是事务独占状态，当参与者占有公共资源时，第三⽅节点访问公共资源被阻塞。</p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.029.png" alt> 单点问题</p>
<p>⼀旦协调者发⽣故障，参与者会⼀直阻塞下去。</p>
<p>![](../../../../images/post-images/bigData/Aspo</p>
<p>在第⼆阶段中，假设协调者发出了事务 commit的通知，但是因为⽹络问题该通知仅被⼀部分参与者所收到并执⾏ commit，其余的参与 者没有收到通知⼀直处于阻塞状态，这段时间就产⽣了数据的不⼀致性。</p>
<p>Three Phase分别为 CanCommit、 PreCommit、 DoCommit。</p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.031.png" alt></p>
<p><strong>三阶段提交针对两阶段提交做了改进：</strong></p>
<ul>
<li>引⼊超时机制。在 2PC中，只有协调者拥有超时机制， 3PC同时在协调者和参与者中都引⼊超时机制。</li>
<li>在第⼀阶段和第⼆阶段中插⼊⼀个准备阶段。保证了在最后提交阶段之前各参与节点的状态是⼀致的。</li>
</ul>
<p>Paxos算法</p>
<p>应⽤最⼴的分布式⼀致性算法。</p>
<p>节点⻆⾊</p>
<ul>
<li>Proposer:提案者 ;</li>
<li>Acceptor:批准者 ;</li>
<li>Learner:学习者 ;</li>
</ul>
<p>约束条件：</p>
<ul>
<li>Acceptor必须接受它收到的第⼀个提案；</li>
<li>如果⼀个提案的 v值被⼤多数 Acceptor接受过，那后续的所有被接受的提案中也必须包含 v值（ v值可以理解为提案的内容，提案 由⼀个或多个 v和提案编号组成）；</li>
<li>如果某⼀轮 Paxos 协议批准了某个 value，则以后各轮 Paxos 只能批准这个 value；</li>
</ul>
<p>通信， 两个阶段 4个过程 ：</p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.032.jpeg" alt></p>
<p>选举</p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.033.png" alt></p>
<p><a href="**⽤户购买商品统计表**--**buy\_cnt\_per\_hour**">^1</a><strong>⼤数据当今的趋势与潮流</strong></p>
<p><strong>流批⼀体实时计算 数据湖 ⽆服务化</strong>(serverless) <strong>应⽤层⾯</strong>–<strong>低代码化</strong></p>
<p><strong>⼆</strong>.Flink SQL <strong>构建端到端的实时数据应⽤简单</strong>Demo<strong>演示</strong></p>
<p><strong>基于</strong>docker<strong>集成组件</strong></p>
<ul>
<li><strong>Flink SQL CLI:</strong> used to submit queries and visualize their results.</li>
<li><strong>Flink Cluster:</strong> a Flink JobManager and a Flink TaskManager container to execute queries.</li>
<li><strong>MySQL:</strong> MySQL 5.7 and a pre-populated category table in the database. The category table will be joined with data in Kafka to enrich the real-time data.</li>
<li><strong>Kafka:</strong> mainly used as a data source. The DataGen component automatically writes data into a Kafka topic.</li>
<li><strong>Zookeeper:</strong> this component is required by Kafka.</li>
<li><strong>Elasticsearch:</strong> mainly used as a data sink.</li>
<li><strong>Kibana:</strong> used to visualize the data in Elasticsearch.</li>
<li><strong>DataGen:</strong> the data generator. After the container is started, user behavior data is automatically generated and sent to the Kafka topic. By default, 2000 data entries are generated each second for about 1.5 hours. You can modify DataGen’s speedupparameter in docker-compose.yml to adjust the generation rate (which takes effect after Docker Compose is restarted).</li>
</ul>
<p><strong>相关的</strong>flinkSQL</p>
<p><strong>数据流外部表构建</strong></p>
<p><strong>⽤户⾏为⽇志表</strong>–<strong>user_behavior</strong></p>
<p>[^2] CREATE TABLE user_behavior (<img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.034.png" alt></p>
<p>2  user_id BIGINT,<br>2  item_id BIGINT,<br>2  category_id BIGINT,<br>2  behavior STRING,<br>2  ts TIMESTAMP(3),<br>2  proctime AS PROCTIME(),   – generates processing-time attribute using computed column</p>
<p>8 WATERMARK FOR ts AS ts - INTERVAL ‘5’ SECOND  – defines watermark on ts column, marks ts as even 9 ) WITH (</p>
<p>10 ‘connector’ = ‘kafka’,  – using kafka connector</p>
<p>11 ‘topic’ = ‘user_behavior’,  – kafka topic</p>
<p>12 ‘scan.startup.mode’ = ‘earliest-offset’,  – reading from the beginning</p>
<p>13 ‘properties.bootstrap.servers’ = ‘kafka:9094’,  – kafka broker address</p>
<p>14 ‘format’ = ‘json’  – the data format is json 15 );</p>
<p>2  hour_of_day BIGINT,<img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.035.png" alt><br>2  buy_cnt BIGINT<br>2  ) WITH (</p>
<p>5 ‘connector’ = ‘elasticsearch-7’, – using elasticsearch connector</p>
<p>6 ‘hosts’ = ‘<a href="http://elasticsearch:9200&#39;" target="_blank" rel="noopener">http://elasticsearch:9200&#39;</a>,  – elasticsearch address</p>
<p>7 ‘index’ = ‘buy_cnt_per_hour’  – elasticsearch index name, similar to database table name 8 );</p>
<p><strong>实现实时统计每天各时段商品购买量统计</strong></p>
<p>[^3] INSERT INTO buy_cnt_per_hour<img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.036.png" alt></p>
<p>[^4] SELECT HOUR(TUMBLE_START(ts, INTERVAL ‘1’ HOUR)), COUNT(*) [^5] FROM user_behavior</p>
<p>[^6] WHERE behavior = ‘buy’</p>
<p>[^7] GROUP BY TUMBLE(ts, INTERVAL ‘1’ HOUR);</p>
<p><strong>cumulative_uv 外部表</strong></p>
<p>1  CREATE TABLE cumulative_uv (<img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.037.png" alt><br>1  date_str STRING,<br>1  time_str STRING,<br>1  uv BIGINT,</p>
<p>5 PRIMARY KEY (date_str, time_str) NOT ENFORCED [^8] ) WITH (</p>
<p>[^9] ‘connector’ = ‘elasticsearch-7’,</p>
<p>[^10] ‘hosts’ = ‘<a href="http://elasticsearch:9200&#39;" target="_blank" rel="noopener">http://elasticsearch:9200&#39;</a>,</p>
<p>[^11] ‘index’ = ‘cumulative_uv’</p>
<p>[^12] );</p>
<p><strong>实现实时每</strong>10<strong>分钟唯⼀访客的累计统计</strong></p>
<p>1  INSERT INTO cumulative_uv<img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.038.png" alt><br>1  SELECT date_str, MAX(time_str), COUNT(DISTINCT user_id) as uv<br>1  FROM (<br>1  SELECT</p>
<p>5 DATE_FORMAT( ts, ‘yyyy-MM-dd’) as date_str,</p>
<p>6 SUBSTR(DATE_FORMAT( ts, ‘HH:mm’),1,4) || ‘0’ as time_str,</p>
<p>7  user_id<br>7  FROM user_behavior)<br>7  GROUP BY date_str;</p>
<p><strong>顶级品类分布维度外部表</strong></p>
<p>12 );<img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.039.png" alt></p>
<p><strong>顶级品类分布计算结果外部表</strong></p>
<p>1  CREATE TABLE top_category (<img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.040.png" alt><br>1  category_name STRING PRIMARY KEY NOT ENFORCED,<br>1  buy_cnt BIGINT<br>1  ) WITH (</p>
<p>5 ‘connector’ = ‘elasticsearch-7’,</p>
<p>6 ‘hosts’ = ‘<a href="http://elasticsearch:9200&#39;" target="_blank" rel="noopener">http://elasticsearch:9200&#39;</a>,</p>
<p>7 ‘index’ = ‘top_category’ 8 );</p>
<p><strong>⾏为表与品类纬度表实时关联虚拟视图</strong></p>
<p>1  CREATE VIEW rich_user_behavior AS<img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.041.png" alt><br>1  SELECT U.user_id, U.item_id, U.behavior, C.parent_category_name as category_name<br>1  FROM user_behavior AS U LEFT JOIN category_dim FOR SYSTEM_TIME AS OF U.proctime AS C<br>1  ON U.category_id = C.sub_category_id;</p>
<p><strong>实时计算顶级品类分布</strong></p>
<p>1  INSERT INTO top_category<img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.042.png" alt><br>1  SELECT category_name, COUNT(*) buy_cnt<br>1  FROM rich_user_behavior<br>1  WHERE behavior = ‘buy’<br>1  GROUP BY category_name;</p>
<p>Kibana<strong>可视化</strong></p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.043.jpeg" alt></p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.044.jpeg" alt></p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.045.jpeg" alt></p>
<p><strong>三</strong>.<strong>学习渠道与图书推荐</strong></p>
<p><strong>计算机体系原理必读</strong></p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.046.jpeg" alt></p>
<p><strong>分布式经典</strong></p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.047.jpeg" alt></p>
<p><strong>⼤数据技术栈相关</strong></p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.048.jpeg" alt></p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.049.jpeg" alt></p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.050.jpeg" alt></p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.051.jpeg" alt></p>
<p><strong>其他⼀些相关和拓展</strong></p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.052.jpeg" alt></p>
<p><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.053.jpeg" alt><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.054.png" alt><img src="../../../../images/post-images/bigData/Aspose.Words.7df77b81-7b9a-40c4-b0c6-732c8f053766.055.png" alt></p>
<p>[^2]: CREATE TABLE buy_cnt_per_hour (<br>[^3]: CREATE TABLE category_dim (<br>[^4]: <code></code>sub_category_id BIGINT,<br>[^5]: <code></code>parent_category_name STRING<br>[^6]: ) WITH (<br>[^7]: ‘connector’ = ‘jdbc’,<br>[^8]: ‘url’ = ‘jdbc:mysql://mysql:3306/flink’,<br>[^9]: ‘table-name’ = ‘category’,<br>[^10]: ‘username’ = ‘root’,<br>[^11]: ‘password’ = ‘123456’,<br>[^12]: ‘lookup.cache.max-rows’ = ‘5000’,</p>
<pre><code>11 &apos;lookup.cache.ttl&apos; = &apos;10min&apos;
</code></pre>
          
        
      
    </div>
    
    
    

    <div>
          
    </div>

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://seasand1024.github.io/2022/10/02/圣诞树与新月/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="安徒生">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/head.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr_Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/10/02/圣诞树与新月/" itemprop="url">圣诞树与新月</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-10-02T01:18:25+08:00">
                2022-10-02
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/现代诗/" itemprop="url" rel="index">
                    <span itemprop="name">现代诗</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>当雨淅淅沥沥之时<br>是你照耀着我<br>夏夜中的皓月<br>星星们喃喃低语<br>它们犹如圣诞树般<br>为你我欢声歌唱<br>曾经多少个夏夜<br>那成千上万件微不足道的<br>你未知晓的事<br>纠结缠绕于我心中</p>
<p>我正沦陷于你的双眸中<br>就像仲夏夜飘落的初雪一般<br>你便是这如同难以置信的奇迹般<br>令人惊叹的瞬间</p>
<p>或许你知道的<br>关于你 存在着只有我一人知晓的模样<br>纵使在这仲夏夜吹拂而来的风<br>我心绪纷飞<br>也会一直等你<br>就像圣诞树与新月<br>我只是渴望<br>与你同在同一片天空下</p>

          
        
      
    </div>
    
    
    

    <div>
          
    </div>

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://seasand1024.github.io/2021/06/25/hive面试常见题目/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="安徒生">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/head.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr_Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/06/25/hive面试常见题目/" itemprop="url">hive面试常见题目</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-06-25T20:05:40+08:00">
                2021-06-25
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据开发/" itemprop="url" rel="index">
                    <span itemprop="name">数据开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-hive关联数据倾斜："><a href="#1-hive关联数据倾斜：" class="headerlink" title="1.hive关联数据倾斜："></a>1.hive关联数据倾斜：</h4><p>原因：</p>
<ul>
<li>key分布不均匀；</li>
<li>业务本身的特性；</li>
<li>建表时考虑不周；</li>
<li>某些SQL语句本身就有数据倾斜；</li>
</ul>
<p>解决办法：</p>
<ul>
<li>set hive.groupby.skewindata=true;</li>
<li>小表大表join，reduce join=&gt;map join;</li>
<li>大表大表join,key 前缀加随机数字；</li>
<li><a href="https://zhuanlan.zhihu.com/p/105987407" target="_blank" rel="noopener">知乎hive数据倾斜解决方案；</a></li>
<li><a href="https://tech.meituan.com/2016/05/12/spark-tuning-pro.html" target="_blank" rel="noopener">拓展：spark 数据倾斜美团处理方案；</a></li>
<li><a href="https://tech.meituan.com/2016/04/29/spark-tuning-basic.html" target="_blank" rel="noopener">拓展：spark调优优化；</a></li>
</ul>
<p><br></p>
<h4 id="2-hive架构："><a href="#2-hive架构：" class="headerlink" title="2.hive架构："></a>2.hive架构：</h4><p><img src="../../../../images/post-images/up-49a57d36a42afebe3bfcafc55c719b228b4.JPEG" alt="img.png"><br><br></p>
<h4 id="3-四个by-的区别："><a href="#3-四个by-的区别：" class="headerlink" title="3.四个by 的区别："></a>3.四个by 的区别：</h4><ul>
<li>Sort by :在数据进入reducer前完成排序,当mapred.reduce.tasks&gt;1时，只能保证每个reducer的输出有序，不保证全局有序；</li>
<li>Order by:全局排序,对输入的数据做排序，故此只有一个reducer(多个reducer无法保证全局有序),只有一个reducer，会导致当输入规模较大时，需要较长的计算时间；</li>
<li>Distribute by:按照指定的字段对数据进行划分输出到不同的reduce中，常和sort by一起使用，并且distribute by必须在sort by前面；</li>
<li>Cluster by:相当于distribute by+sort by，只能默认升序，不能使用倒序；<br><br></li>
</ul>
<h4 id="4-常用函数："><a href="#4-常用函数：" class="headerlink" title="4.常用函数："></a>4.常用函数：</h4><h5 id="1-行转列函数"><a href="#1-行转列函数" class="headerlink" title="(1)行转列函数"></a>(1)行转列函数</h5><ul>
<li>concat：连接各个字段，eg:concat( aa, ‘:’, bb)，只要其中一个是NULL，那么将返回NULL;</li>
<li>concat_ws：使用分隔符连接字段，分隔符尾第一个参数，eg:concat_ws(‘-‘,’a’,’b’)，只要有一个字符串不是NULL，就不会返回NULL;</li>
<li>collect_set(col)：函数只接受基本数据类型，它的主要作用是将某字段的值进行去重汇总，产生array类型字段;<h5 id="2-列转行函数"><a href="#2-列转行函数" class="headerlink" title="(2) 列转行函数"></a>(2) 列转行函数</h5></li>
<li>explode(col)：将hive某列中复杂的array或者map结构拆分成多行;</li>
<li>lateral view：常和UDTF函数一起使用;</li>
<li>解释：用于和split, explode等UDTF一起使用，它能够将一列数据拆成多行数据，在此基础上可以对拆分后的数据进行聚合;</li>
<li>eg:SELECT username, role FROM ods.ods_actor_data LATERAL VIEW explode(split(userrole, ‘,’)) tmpTable AS role;<br><br></li>
</ul>
<h4 id="5-Rank排名函数："><a href="#5-Rank排名函数：" class="headerlink" title="5.Rank排名函数："></a>5.Rank排名函数：</h4><ul>
<li>rank() : 排序相同时会重复，总数不会变；</li>
<li>dense_rank() : 排序相同时会重复，总数会减少;</li>
<li>row_number() : 排序相同时不会重复，根据排序计算排名;<br><br><strong>在实际开发中，以上三个rank函数通常是和开窗函数一起使用的。</strong></li>
</ul>
<h4 id="6-窗口函数（开窗函数）"><a href="#6-窗口函数（开窗函数）" class="headerlink" title="6.窗口函数（开窗函数）"></a>6.窗口函数（开窗函数）</h4><ul>
<li>over()  :用于指定分析函数工作时的数据窗口大小，这个数据窗口大小可能会随着行的变而变化； </li>
<li>current row :当前行；</li>
<li>n PRECEDING :往前n行数据；</li>
<li>n FOLLOWING: 往后n行数据； </li>
<li>UNBOUNDED：起点，UNBOUNDED PRECEDING 表示从前面的起点， UNBOUNDED FOLLOWING表示到后面的终点；</li>
<li>LAG(col,n,default_val)：往前第n行数据； </li>
<li>LEAD(col,n, default_val)：往后第n行数据；</li>
<li>NTILE(n)：把有序分区中的行分发到指定数据的组中，各个组有编号，编号从1开始，对于每一行，NTILE返回此行所属的组的编号。这个函数需要注意：n必须为int类型。<br><br></li>
</ul>
<h4 id="7-UDF、UDAF、UDTF的区别？"><a href="#7-UDF、UDAF、UDTF的区别？" class="headerlink" title="7.UDF、UDAF、UDTF的区别？"></a>7.UDF、UDAF、UDTF的区别？</h4><ul>
<li>UDF：User-Defined-Function，用户自定义函数，数据是一进一出，功能类似于大多数数学函数或者字符串处理函数；</li>
<li>UDAF：User-Defined Aggregation Function，用户自定义聚合函数，数据是多进一出，功能类似于 count/max/min；</li>
<li>UDTF：User-Defined Table-Generating Functions，用户自定义表生成函数，数据是一进多处，功能类似于lateral view explore()；<br><br></li>
</ul>
<h4 id="8-怎么自定义UDF、UDAF、UDTF函数？"><a href="#8-怎么自定义UDF、UDAF、UDTF函数？" class="headerlink" title="8.怎么自定义UDF、UDAF、UDTF函数？"></a>8.怎么自定义UDF、UDAF、UDTF函数？</h4><p><br></p>
<h4 id="9-hive优化相关面试题"><a href="#9-hive优化相关面试题" class="headerlink" title="9.hive优化相关面试题"></a>9.hive优化相关面试题</h4><ul>
<li>MapJoin：如果不指定 MapJoin 或者不符合 MapJoin 的条件，那么 Hive 解析器会将 Join 操作转换 成 Common Join，即：在 Reduce 阶段完成 join容易发生数据倾斜,可以用MapJoin把小 表全部加载到内存在 map 端进行 join，避免 reducer 处理;</li>
<li>行列过滤：列处理：在 SELECT 中，只拿需要的列，如果有，尽量使用分区过滤，少用 SELECT *;</li>
<li>行处理：在分区剪裁中，当使用外关联时，如果将副表的过滤条件写在 Where 后面，那 么就会先全表关联，之后再过滤;</li>
<li>使用分桶;</li>
<li><a href="https://zhuanlan.zhihu.com/p/80718835" target="_blank" rel="noopener">知乎hive调优</a>;</li>
</ul>

          
        
      
    </div>
    
    
    

    <div>
          
    </div>

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://seasand1024.github.io/2021/06/23/挪威的森林/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="安徒生">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/head.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr_Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/06/23/挪威的森林/" itemprop="url">挪威的森林</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-06-23T20:55:18+08:00">
                2021-06-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/现代诗/" itemprop="url" rel="index">
                    <span itemprop="name">现代诗</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>与你的相遇</p>
<p>像是夜里与一颗流星的邂逅</p>
<p>在望不到尽头的山野里</p>
<p>彼此相守</p>
<p>往后的岁月里</p>
<p>我们各自奔流</p>
<p>在远方时空里</p>
<p>演绎每一场都市夜景下的灯火通明</p>
<p><br><br>夜里游动，黑猫流窜的小区</p>
<p>给予记忆无声的催眠</p>
<p>彼时年轻人的欢声笑语与热血</p>
<p>都融化做深夜里的一杯杯清酒</p>
<p>随夜色褪去</p>
<p>你是否将我遗忘</p>
<p>如同曾经千千万万个挪威的森林</p>
<p>而终究独身于无人之境</p>
<p><br></p>

          
        
      
    </div>
    
    
    

    <div>
          
    </div>

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://seasand1024.github.io/2021/06/23/意难平/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="安徒生">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/head.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr_Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/06/23/意难平/" itemprop="url">意难平</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-06-23T20:43:21+08:00">
                2021-06-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/现代诗/" itemprop="url" rel="index">
                    <span itemprop="name">现代诗</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>风起意难平</p>
<p>我终究是你故事里的一个配角</p>
<p>风起意难平</p>
<p>我终于将所有遗憾慢慢填满心间</p>
<p>风起意难平</p>
<p>我终究是一个你不会认识的陌生人</p>
<p><br></p>
<p>层楼终身误</p>
<p>你终究是人间里的一介过客</p>
<p>层楼终身误</p>
<p>你终究是神游太虚的一场梦境</p>
<p>层楼终生误</p>
<p>你终将成为谁的新欢与旧爱</p>
<p><br></p>
<p>到底意难平</p>
<p>我们也注定分离</p>
<p><br></p>

          
        
      
    </div>
    
    
    

    <div>
          
    </div>

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://seasand1024.github.io/2021/06/17/一个你不会认识的陌生人/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="安徒生">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/head.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr_Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/06/17/一个你不会认识的陌生人/" itemprop="url">一个你不会认识的陌生人</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-06-17T22:13:25+08:00">
                2021-06-17
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/现代诗/" itemprop="url" rel="index">
                    <span itemprop="name">现代诗</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>漫长的时光里</p>
<p>你独自一个人度过</p>
<p>生命总是孤独</p>
<p>你总是默默承受</p>
<p>即使每一个过客</p>
<p>终究有谢幕离场的时分</p>
<p>我是一个你不会认识的陌生人</p>
<p>你是一道我永远也遇不上的彩虹</p>
<p>没有遇上方知有</p>
<p>好在花有清香月有阴</p>
<p>我们在不同的世界</p>
<p>演绎着类似的人生</p>
<p>陌生的旧情人</p>
<p>你是谁的新欢和旧爱</p>
<p>而我只是一个</p>
<p>你不会认识的陌生人</p>

          
        
      
    </div>
    
    
    

    <div>
          
    </div>

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://seasand1024.github.io/2021/06/17/鄉愁/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="安徒生">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/head.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr_Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/06/17/鄉愁/" itemprop="url">鄉愁</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-06-17T22:08:00+08:00">
                2021-06-17
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/现代诗/" itemprop="url" rel="index">
                    <span itemprop="name">现代诗</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>芦苇飘荡的季节﻿</p>
<p>少年将沉沉的离别披在肩上﻿</p>
<p>乡愁像芦苇荡里的水一样柔﻿</p>
<p>遗忘的日子里﻿</p>
<p>心中总是若有所思﻿</p>
<p>乡愁像渔家的灯火一样引人入眠﻿</p>
<p>岁月像车轮一般轧过如路面荒芜的日子﻿</p>
<p>远处月台橘黄色的站台灯碰弯了旅人的思绪﻿</p>
<p>恍惚流失的光阴迷失在记忆的岔道口﻿</p>
<p>春日大海的阳光照耀着北回归线﻿</p>
<p>视野里的芦苇叶子眯成一线﻿</p>
<p>蓝的海黑的海 逐渐缩成点的海鸥﻿</p>
<p>露水闪透着晶莹的清晨﻿</p>
<p>列车经过铁轨吸进一个个影子后逝去﻿</p>
<p>乡愁像一曲永不停息的曲子﻿</p>
<p>在风尘苦旅的夜里奏起</p>

          
        
      
    </div>
    
    
    

    <div>
          
    </div>

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://seasand1024.github.io/2021/06/17/無題/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="安徒生">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/head.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr_Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/06/17/無題/" itemprop="url">無題</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-06-17T22:07:00+08:00">
                2021-06-17
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/现代诗/" itemprop="url" rel="index">
                    <span itemprop="name">现代诗</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>就像没说完的一段故事</p>
<p>就像断了的弦</p>
<p>孤寂在夜空盘旋</p>
<p>旅人在灯下行走</p>
<p>车辆穿梭于漆黑的夜</p>
<p>喧嚣隐去于沉睡的异世界</p>
<p>圆月下的立交桥路面</p>
<p>水银镜一般映射光华</p>
<p>深夜的路灯</p>
<p>独自闷不吭声</p>
<p>光线四处逃窜</p>
<p>疲惫不堪的倒在地上</p>
<p>摸索着所有能触及的黑暗</p>
<p>潮水在离森林不远处翻滚声息</p>
<p>萤火虫于溪岸跃动身影</p>
<p>追寻</p>
<p>自黄昏到黑夜</p>
<p>流动的城市灯火</p>
<p>停留于指尖瞬间</p>
<p>抑或</p>
<p>雨中潮湿的羽翼</p>
<p>在遥远的空中挥动</p>
<p>在视野中渐行渐远</p>

          
        
      
    </div>
    
    
    

    <div>
          
    </div>

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://seasand1024.github.io/2021/06/17/新辞/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="安徒生">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/head.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr_Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/06/17/新辞/" itemprop="url">新辞</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-06-17T22:01:56+08:00">
                2021-06-17
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/古风拾迹/" itemprop="url" rel="index">
                    <span itemprop="name">古风拾迹</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>歌管楼台声细细，秋千院落夜沉沉。</p>
<p>徒有斜阳与人语，不念故乡念旧人。</p>
<p><img src="../../../../images/post-images/10224563-bb430fb614396c21.jpg" alt="img.jpg"></p>

          
        
      
    </div>
    
    
    

    <div>
          
    </div>

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/head.gif" alt="安徒生">
            
              <p class="site-author-name" itemprop="name">安徒生</p>
              <p class="site-description motion-element" itemprop="description">人生没有回头路</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">30</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">19</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/SeaSand1024" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:2215205259@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                友情链接
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.bilibili.com" title="Bilibili" target="_blank">Bilibili</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.google.com" title="Google" target="_blank">Google</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.nature.com" title="Nature" target="_blank">Nature</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.jos.org.cn" title="Jos" target="_blank">Jos</a>
                  </li>
                
              </ul>
            </div>
          

          <div id="music163player">
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=442488&auto=1&height=66"></iframe>
</div>
        </div>
      </section>

      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">安徒生</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
